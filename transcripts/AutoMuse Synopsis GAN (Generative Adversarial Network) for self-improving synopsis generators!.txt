morning everybody David Shapiro here with some more Auto Muse work um so today we are going to focus on um generative adversarial Networks um specifically for generating uh synopsis um because that's where a story starts you need something to go off of um and so this the the synopsis is the kernel it is the seed of a story it is a premise it is a story premise or a set of ideas that can be expanded upon whether or not you're plotting or pantsing you still need an idea to start from and so this is where all uh generative fiction artificially Intel AI fiction is going to start is with some kind of premise so what I'm doing is I'm um I'm crippling this um this synopsis that's supposed to be grade one so what I'm doing is I'm removing all names from it because one thing that I noticed um that gpt3 does is uh sometimes when it generates garbage it has no names so so I'm just going to actually do this and find and replace all instances of Kwanzaa with nothing and so that way it has an example of what is it what is an actual garbage um uh uh synopsis there we go word sorry about that um all right so then what we're going to do is we're going to find and replace any cases of too many spaces and we'll just replace it with one there we go okay so in this case um we're going to also remove uh because one thing that I found that it does is um The Vicious fighter um finally defeats the fighter is it will give you very generic boilerplate stuff so the whole reason is this is now worse because like yes it's a story but there's no names um oh here let's take out an aging master so we'll just say um yeah there we go cool so now we've got this kind of General generic boilerplate story that has no names no locations um so this is this is a grade one it is a garbage and then we have this other one that is long it's got specific years and locations um it's got names um oh we need to remove end because I don't like it when that when it puts that in there okay and then we've got another we've got a middle of the road one which does have names and places and it's got you know it's it's good but what we really are looking for is something that is solid and so to give a little bit of background I mentioned generative adversarial networks so what I was working on was a um a uh a function here in the generate synopsis so first I've got the generate many which this is this is what I showed before which is if you just want to spam out and generate a whole bunch of data here you go this is how to do it but what I'm going to do is do um def uh let's see we'll do um synopsis Gan um and then I think we probably don't need any variables to go in with that so first we will I think we need to separate out the variables because we want to generate multiple synopsis with the same variables so here we'll do um def uh let's see pick variables and so then we'll do we'll separate this out and this is yeah so we'll copy this up here pick random variables and then we will just return genre tone character paste storyline uh style setting and time period okay so then we'll say these equal pick variables okay so now we've separated out the variables so we can copy this and just bring and just grab it once for when we do for when we do the Gan so we're going to pick we're going to pick all of our variables so that we can we can do it uh multiple times and then we'll say while true um so that we'll get caught in an infinite Loop and basically what we're going to be looking for is we're going to continue generating um synopsis until we get a rank 5 synopsis um okay so with that said um we will do actually generate synopsis we should have rather than pick the variables we should just accept them here and then when we need them foreign we will do it this way there you go that's more appropriate so you're you're going to ask it to generate a synopsis with a given set of variables um there you go print the terms probably don't yeah that's fine we can keep that there um yes okay and so that does a little bit of cleanup and then we let's see what's the temperature the temperature is at 1.1 so you want you want to generate Fiction with a high temperature because you'll get a lot more variation that way now part of the problem though is that you you get higher variation so sometimes it'll generate a short garbage synopsis sometimes it'll generate a long one sometimes it'll just write the story so you want you want to kind of hone in on the the what you want exactly okay so while true um synopsis equals or let's see we'll say um oh yeah so we'll say synopsis equals generate synopsis so we'll just copy this um all right so we'll get a synopsis but then we also want to rank the synopsis so let's split this out as a def as a um as its own uh function So Def and we'll say um grade synopsis so then we'll say pass me the synopsis and synopsis is one of those words that when you say it too many times it feels like it loses all meaning also the camera looks like it's pointing up that looks a little bit better okay um all right so the first thing we do is prompt equals open file um and it's called prompt grade dot text and then synopsis is the story okay so we'll do dot replace story with the synopsis and then we'll do um grade equals gpt3 completion prompt and in this case we actually want to change the temp to zero because then you want it to be deterministic in terms of um what it spits out and this reliably um this reliably generates just a uh where am I going um reliably generates just you know the the grade um okay so then we'll say uh let's see while true synopsis um oh yeah so that's fine and then we'll return the grade so the grade should be a string um like uh let's see whoops one or three or whatever okay so then we'll say grade equals grade synopsis and we'll pass it the synopsis that it just generated so what we're doing is we're only we're generating the variables once right and then we will we will generate um the synopsis oh we should probably print out the synopsis too because here let's remove this we'll print out the terms only once so that's fine and then we will um then we'll print out the synopsis so copy that do synopsis and then we'll print grade let's add a little bit of dressing so do grade so that way we get the synopsis and the grade and then um if grade equals five so this is what we're looking for we're looking for a grade five synopsis we'll say uh we'll just um probably save it and print it out or save it uh yeah just save it save a unique ID and file name save file file name synopsis and then we'll do exit exit I can type I promise with Code Zero so code 0 is like the standard exit which is the thing succeeded okay so then we'll call seed only once and then we'll do synopsis gan and let's see if it works so then we'll do CD um CD synopsis generator let me make this a little bit bigger for you properties 30s that's too big okay and so then we'll do python generate synopsis all right and there's all kinds of things that you can do to improve this so we've got this let's see what happens so it's generating a synopsis in the background right now uh let's see oh it's too long you requested 5300 tokens 2300 in your prompt and 3 000 in the Watchman jig okay so we need to shorten our our window which is this right here so let's take this down to a thousand let's try that again a psychological Thriller in Scandinavia in the early classical it's noisy um it's culturally diverse okay so this is a grade four um yeah so you see here it generated one where it just says the novel begins with our protagonist a young woman it doesn't give her a name so yeah we don't we don't like that one because that is no good um let's see synopsis Karen is a young woman of color living in Scandinavia okay that's a little bit better still it's not that long so let's generate another one and so the idea here is that you have a generator and a discriminator so the generator is trying to come up with story ideas and then the discriminators saying that's not quite good enough and then when you look at uh let's see why is this in two interesting um so ideally you will get uh we'll see we'll let it go until it gets until it spits out one that it says is a is a grade five um so we'll see what happens grade four so it's reliably generating uh grade four um and some of these look like they're probably good so I might need to go back and do some work on the um on the actual uh on the on the the grading thing but so here's the idea is with a generator and discriminator the they're both competing against each other so the generator is trying to get better at generating whatever it's trying to do and the discriminator is also trying to get better and so how do you do that right how do you have a discriminator that gets better at discriminating versus a generator that gets better at generating because if the J if the discriminator is just giving a rank how does it know that it's giving a good rank that I'm not sure how to do yet um but we'll see we'll let this go until it gives until it gives us a um until it gives us a rank five um I'll pause this um and let it go until until we're done um because I have no idea how long it's going to take and then we'll we'll evaluate um evaluate what it shows and why okay looking at some of these um I think I've probably got to do some work on my um on my discriminator because these actually look pretty good in this in the town of stromstad Sweden so one it immediately establishes the setting um immigrant families from all over the world have settled the town is a Melting Pot of cultures and traditions the residents are proud of their diversity however there is one family that is not like the other others the kovic family are Romani gypsies um probably shouldn't have used gypsies that is no longer in Vogue you're supposed to say well I guess it said Roma or Romani um they've been living on the outskirts of stromstad for Generations they're a tight-knit community um they stick to their own the residents view the kovics with as dirty and dangerous so this is all good she goes to school makes friends so it's a little girl however the residents of stromstad still view her as an outsider even sure that she's just run away again but Jacob doesn't come home after a few days Eva starts to worry um her own culture she also starts to understand the Prejudice of the kovic's face okay this is great this is a great coming of coming of age um and they're starting slowly starting to accept them okay so I'm going to grab this as a rank five because this is definitely a good good one it is it is good enough um okay the only thing missing is the time period so in the town of Strom said Sweden um the year was supposed to be let's see if we scroll up um psychological Thriller Scandinavia early classical I kind of ignored that um so we'll say like um I guess this could take place at any time period but having having a definitive time period is required um for for a for a story to be good because that's part of setting so there's three primary ingredients to any story it's like three legs of a stool so you need setting plot and character setting is composed of uh location or locations it also has to have culture time period uh language religion whatever whatever's going on whatever's socially going on so it tell it talks about the setting really well um it gives you the name it gives you that but we don't have a time period um and so this could be in let's say the 1970s um settled during the 1970s so we'll make this just a little bit better because that because the time period gives you some anchoring and of course this story could be any time right um and yeah is not as welcoming as she thought this this is good um we can remove the ending because I've got that figured out uh yeah so we got nice and short and then we've got one that is Rock Solid robust um and then we've got one this one is actually okay um so what I'll do is I'll this one a little bit more um yeah I wonder I wonder if it was confused because this one is like it is complete so let's grab yeah this one this one is this one is low quality because it has no but I gave it a four right um so I'll copy that as a one and then so we've got a five so let's find a let's find something that I feel like is truly a three tormented by Inner Demons so this one's interesting because it's pretty long so anyways what what you would do is you would accumulate um a bunch of these and grade them and and fine-tune a model that is going to generate based on um the inputs so what you need what I'll need to do is record the inputs um and there's all kinds of different ways to record the inputs so let me actually take a note of this so um let's see overall gold who do sources process um uh let's see input formats so one input format is just um list of appeal terms which is what we're doing now um another thing would be a chat log so like between a a an author and a reader um or a librarian and a patron and so because one way that you find books is that you have a conversation right and so by having by having training data where you have a conversation with someone where it's like what kind of story do you want to read let me ask you all kinds of things about a story that you want to read um and that's called a reference interview um so uh let's see AKA reference interview and gpt3 knows how to do a reference interview so list of appeal terms a reference interview um let's see a uh something that's like I want I want to book that dot dot dot where you just kind of stream of Consciousness um that sort of thing and so the idea here is that you train it to um oh here we go um list of comp titles there we go okay so the idea is that you train it on a variety of input formats but what it always does is it always outputs um it always outputs a synopsis a good plot synopsis and so you want it to conform to certain standards right um so process um then we'll do I need to clean up this this document but the discriminator for uh synopsiscan um so uh let's see uh um must have all three pillars [Music] um plot character setting um let's see all characters must be named um setting must be named dated and described Etc and then plot needs clear beginning middle and end with narrative progression and or character arcs um actually I guess the character arcs um all characters must be named and have arcs um okay so basically you're kind of establishing the criteria of by which you're going to measure the the synopsis that are generated also let me do a quick time check okay we're already at 21 minutes so I might call it here uh because you all seem to like these shorter videos where they're around 20 to 30 minutes some people really like ones that are longer um but anyways so I did do a fine tune model so let me let me just go ahead and pause and show you the fine-tuned model that I did audio transcribe oh that's the new engine I'm like huh um Okay cool so that's that must be the whisper engine all right so synopsis so let's see um I want a story like Harry Potter um but much darker and in space so they're like epic Space Opera um dark and violent um uh uh let's see romantic subplot um okay and so then we do synopsis and this is the this is my first fine-tuning experiment with this we'll turn the temperature up and we'll turn that up to a thousand let's see what it does not bad here we go so this the the fine-tuning training data for this is right here synopsis.json l so let me show you how this data looks so and you're we're welcome to use this just be careful because it costs about thirty dollars to fine tune this one so the input is it's just a brief description with then a list of appeal terms and then synopsis it follows that same format and then the completion is a synopsis so the idea here though is rather than humans go in and rate the synopsis based on the input I want to have that Gan where you have several input formats and then it generates a good synopsis but then we also have so that will learn to get better but then the discriminator gets better right so how do we do that I haven't quite figured that out because if you have two engines that are feeding off of each other and competing one they're both trying to get better over time ideally this should ultimately create really robust uh great plot synopses um and so we'll see about how to do that but let's see what this um what this generated okay so um The Story begins in a dark gritty alternate universe the main character a young woman named Delphine is kicked is a kicked around Misfit she's been raised by a single mother who's never seemed to care about her and she's constantly picked on by her classmates wow that's an awful life delphine's only Solas is her Daydreams which she imagines as Grand adventures and alternate alternate universes One Day delphine's Dreams came true come to life when she suddenly transported to another world this other world is a magical Place full of amazing creatures and Adventures she quickly makes friends with a group of other young people who have also been transported to this world okay so this is like a middle grade portal fantasy which I said Harry Potter so there you have it um the Harry Potter is middle grade together they begin to explore their new surroundings and try and figure out how they got there as they investigate they discovered that they're not alone there are others in this who have been brought here before them including some people who are now evil um cool could it be the plot um it turns out that this other world is a place where people's deepest desires and Fantasies come true the problem is that not everyone wants the same thing so conflicts begin to arise this is pretty cool uh Delphine and her friends must band together to try and stop the fighting to find a way back to their own world kind of reminds me of Sucker Punch as the story progresses it becomes clear that this other world is not a place where everyone can stay happy ah there is the moral is it if you if you live in a world of fantasy so this is the theme this is one thing that I found is that gbt3 is actually really good at theme if you don't tell it to so theme the the theme is really confusing especially to people who are not familiar with with story structure the rule of thumb for theme is that it is a universal truth and so universal truth is something that is true about the human condition that is explored via story now myths and Parables use magic or technology you know fantasy elements to remove human constraints to then explore that universal truth and so the universal truth here is that okay imagine that you're transported to a world where everyone gets what they want but conflict still happens so the moral here the universal truth the theme is that you can't just be handed what you want life isn't that easy um okay so let's see um let's see as the story progresses it becomes clear that the world is not a place where everyone can stay happy those who want something that others don't must choose sides and the lines are quickly drawn yes that is human nature is I want this and it's mutually exclusive with what you want so let's fight over it um sounds like politics in which Delphine and her friends ReDiscover politics okay Delphine and her friends find themselves in the middle of a war that they never wanted so this is supposed to be a Dreamland but they end up in a war on one side is a group of people who want to keep the world as it is where everyone's dreams come true on the other is ones who want to change it so that only the right kind of dreams can stay ah censorship another another moral theme has emerged um Delphine and her friends are caught in the middle and they must find a way to stop the fighting before it's too late the war heats up and Delphine and her friends are in the middle of the Bloodshed they find themselves facing off against the former friends and allies and it becomes clear that there's no going back Delphine and her friends find a way to stop the fighting but at Great cost they're the only ones who escape the other world and they're left with the knowledge that their friends and loved ones are now dead that sucks Delphine is left with a deep sense of loss and grief but she also gains a new appreciation for the simple day-to-day things in life so she has learned to stop daydreaming Ending delphine's Story ends with her returning to normal life she's changed by her experience in the other world and now she's more thoughtful and considerate person she's also gained new respect for the people around her even though she didn't used to like Delphine eventually finds love and starts a family of her own she still Daydreams from time to time but she knows that that they're just that it's Daydreams she's content with her life um and then it repeats the ending several times so this is where with fine-tuning data you need even more samples than what I gave it oh actually no what it did I forgot to put in the stop sequence ah yes actually no see that would have hmm interesting anyways so there is a stop sequence um so uh end right so it would have stopped here um so this oops let's see no ending the first ending so this is where it should have stopped um this is this would be a satisfying conclusion deep sense of loss and grief but she also gains a new appreciation for the simple day-to-day things in life so that is she emerges from the underworld as a changed person okay and I noticed the little uh the little speech to text thing here um so I'm gonna give that a try real quick but anyways um so yeah epic Space Opera dark and violent romantic subplot so it didn't get the Romantic subplot again this is a work in progress um and it also only gave me one named character so we'll give this a solid three or four um out of five um if it if it if this was good um it you know it got the epicness it got the dark and violent it missed the Romantic subplot and it didn't um it didn't give me too much about the setting right it gave me her backstory that's that's good but we need other characters now that being said I'm not too worried about that because part of the process of what I'm working on with auto Muse is you take a premise and you expand it and so one thing that you can do is you can just say like given the following premise here let me show you this is something that I was working on um so let's see given the following uh plot synopsis um brainstorm the cast of characters uh describe each character vividly um let's see Vivid depiction of characters and so then you just say Let It Go Delphine hey this is great um delphine's mother so even here it doesn't give them names um which is really infuriating I worked so long to try and get it to to do it to give us names I did succeed in the plotter method um and basically all you say is like you know describe to each character uh you know um I think you if you add invent names um for them I think that's all you need to do so then we'll do um Delphine dolphin's mother no it didn't work anyways so that's that's another open problem is it's good it it's good at like just taking the story and running running with it but coming up with character names for whatever reason um and place names if it's not in the initial data it's garbage it and it can't do it so that's why fine tuning is necessary anyways um here let's see if this works uh let's see start recording um okay can you use this uh hi so I'm testing the new text-to-speech beta okay hey look at that use his input cool all right so now whisper is embedded in in uh gpd3 all right this went on way longer than I meant to thanks for watching like And subscribe and consider supporting me on patreon have a good one