morning everybody David Shapiro here with another video today we are going to be playing 20 questions with gpt3 um I was inspired because last night I hosted an equinox bonfire and as depicted here sorry for the uh the shaky cam I was using the night sight and uh I guess I wasn't holding the camera that steady but um by the end of the night there was a there was a game of 20 Questions going around and I was just thinking to myself this is a word game this is a perfect use case for gpt3 um now I am also collecting new use cases um for a fine tuning project and I'm particularly interested interested in non-profit and education use cases so if you have any ideas for a fine tuning project please let me know I asked on Twitter and I got a few leads anyways getting distracted let's focus on today which is a game um so yeah uh obviously gpt3 it can't drink a beer with you or help you build a bonfire but maybe it can help you have a little bit of fun and cut loose okay so what are the rules different people play 20 Questions differently where like you can ask a categorical question like you know person place or thing that's how I learned originally um where you it's like you give a one-word answer but I looked up the rules and it's apparently yes or no which makes it even easier to play with a machine um so the step one the machine picks a secret word phrase concept so on um the user must ask yes or no questions and I guess it could be users um and then the machine must answer yes or no unless it's a bad question um I guess so if it's a bad question the machine must refuse to answer and tell you to take a hike and then bad questions count against your total so if you ask you know if you don't ask the if you don't ask a yes or no question then you get uh you know you lose you lose some uh questions remaining um yeah okay so we got to start with um some prompt engineering so first thing we're gonna We want is for the model to pick a word um uid generator so since we want um we want a lot of uh Randomness we we need we'll start off with the uuid technique which just adds a little bit more entropy um and then we'll say like well let's just let's just do it and just like pick a random word development okay whoops drawer ah okay so we need to model what are you doing oh I know what's going on okay okay I was hitting the wrong key okay soccer okay good and it gave me a uuid that's no good um actually I think you can hit regenerate there we go one bad Cow Shed predicted a completion that ends with a stop sequence food okay uh we might need to do fuse shot with this um Okay so yeah because if we if we give it um here I've actually got a writing tool random word um ultian so what we can do is uh it's literally just randomword.com I love this because it gives you rare words like it it doesn't it doesn't give you a distribution based on commonality of words it just like takes a dictionary and just throws a dart at a dartboard um I wonder if I could actually use this as a uh well I guess you don't want it to be too you don't want you don't want to go too late because who's going to guess ulti on that's that that's super hard but actually that's a use case um ooh ooh ooh um let's see uh let's see um difficulty um let's or here just um choose difficulty level based upon commonality of words okay so I've found some vocabulary some vocabulary list wow my mouth is not awake um and I was like these aren't good like eyeball like I that's okay but right that would not be necessarily a good 20 questions one um and that would be kind of difficult um we can make these some more um like the more advanced one but what I'm what I'm doing now is I'm generating a list of list of lists basically to accumulate here so we'll have common words so we've got like here's some food items here's some like physical things um and so what I'll do is I'll dynamically generate I'll pull a sampling from from this file once I clean it up and we will we will uh use that to populate that prompt that I was showing you to generate you know the next random thing um so write a long list of um let's see the most famous people in history and so then um we'll do like we'll start with like George Washington because duh and then we'll do Cleopatra uh and then um uh Confucius so we what we want to tell it like globally right so we've got America Egypt China um that should be a good start Michael Jackson Princess Diana Tiger Woods there we go and then randomly Winston Churchill you don't get a space Winston Churchill okay so then we got famous people um of the most famous places in the world and so then we'll do like New York City we'll do the Eiffel Tower um then let's see the Grand Canyon okay we'll we'll take out the because that's just gonna get Superfluous um uh let's see Nile River um what is the name of that temple in India um Angkor Wat is that that's not in India though is it again we want it we want to tell it like be think Global um because if you don't gpt3 just it always defaults to being very american-centric for some reason okay there we go sequencing genome that's not a place gpt3 nice try okay ah there we go um I guess uh let's do like monuments um and historical sites let's see what it gives us interesting oops some of these are pretty cool a lot of them are Rome so very Western Centric um I guess I did say historical sites um that's fine anyways we don't we don't need a uh an empirical list all we need is something to draw from so let's get rid of those lines and then those we got famous people and this is this is for the easy one anyways um okay so we will find and replace Dash with nothing and then we'll also find and replace space with nothing there we go okay so now we've got a list of common words so then what we'll do is we will um let's see do we have um run random import seed choice all right so what we're going to do is clear this out um to do uh choose difficulty I might just have it where you just swap a variable um okay but let's see seed so we'll get some we'll start we'll start with some entropy I actually found you don't want to call seed repeatedly because then you kind of even though even though it does introduce some entropy you're basically starting over and so you end up with um it'll often make similar choices whoops cancel what I don't know what I did okay um it'll often make similar choices um so you just call seed once or intermittently okay so then we say um seed words equals open file um and we'll do common words dot text split lines and so what this will do is it will open this my Precision is loaded I changed my mouse resolution um so it'll open this and we will grab actually no I don't need I need sample sample okay um and so then uh let's see sampling equals sample um I think it you put it in seed words and then 10 and then we'll do print sampling all right let's make sure I did that right python 20 questions there we go okay so basically what we'll do is we will start with a random sampling and then we will build a prompt from that um so the prompt equals we'll start with string um string EU id4 take that out did I um it didn't print it out that's fine um string uuid4 and then we will do um four S in sampling all right we don't we can obfuscate this and actually we'll just do it this way all right so prompt equals that so for S and sampling or yeah sample seed words 10 we'll do um come back here and look at my history yeah that's what it was come back a little ways I did a whole bunch of these good grief I did way more than I thought I did how many times did I click on this darn thing oh I went back too far there we go okay so we want it to look like this oops so we'll just pick a random word um let's see prompt equals prompt plus and we'll do new line um pick a random word uh percent s and then sample and that should end up giving us this so it'll be perfect and then we'll do prompt equals and we'll just do the same thing but instead we will exclude that and that is going to be the prompt so then we'll just do print prompt yeah cool Mahatma Gandhi Christopher Columbus why are they missing spaces oh whoops I removed all spaces okay so here's a here's a regex trick um you see how a lot of these have a space at the beginning but then they they have spaces here and what I did was I accidentally removed all spaces so what we need to do is we need to remove only spaces at the beginning so what you do is you do carrot which tells it start at the beginning of the string and then you do backslash s for white space and then you do replace all and so that replaced only the spaces at the beginning while preserving the rest all right Confucius Julius Irving salt tomatoes onions Street Pasta House computer milk it's a lot of food I think I just have a lot of food um but this is easy right it's supposed to be easy enough to play with a kid um so we'll go with it for now um but we can also generate plenty more common words and places and things if we want but we gotta we got a good mix okay so now let's plug this into um into our playground do a quick refresh okay and then turn the temperature back up blue ship spoon sunflower soup you see we're not getting the United States of America every other turn Boat fish spice spaghetti boat Dairy truck salmon Dallas Cowboys soup desk Eiffel Tower gospel soap all right soap pops up a lot but so anyways because we're picking a random sampling every time the the profile of what we're gonna is gonna also be different every time um okay so I'm satisfied with that so let's come back into here yeah we don't need that anymore because we've got our prompt so we we're basically just dynamically generating a unique prompt every single time um okay so then um our stop sequence will be we need backslash n to be one of our stop sequences Okay so secret word equals gpt3 completion prompt will also set we'll set the default temperature to let's say 1.2 um so yeah so we've got that we don't need a thousand tokens we'll do we'll we'll leave it to like 100 tokens um for this one Okay so we've we pick a secret word and so then we'll just do print secret word uh just to make sure that it works oh whoops I need to create my gpt3 logs directory I always forget to do this gpt3 lawns crocodile good one computer Jimi Hendrix yes okay I am satisfied that this is a good we're getting a good amount of entropy okay so obviously we don't want to tell you the secret word so then okay uh print um I have picked my secret word um ask your first question and so we'll do um questions remaining equals 20. and we'll probably do something like um questions remaining dollar s and then we'll add percent questions remaining um and we'll just have this in the debug out or in the output every time um okay so then we say while true so we enter into our infinite Loop um the user the read host um let me make sure I remember how to use read oh I'm sorry I forgot to make this bigger sorry everyone's probably squinting at the screen saying Dave make it bigger I can't see there sorry about that okay uh Python and then a equals I think it's just read um read host is Powershell um and then we'll say um ask your question scrub or is it input a equals input ask yeah um bacon and then print a okay it's input not read okay um fair enough so then you say so the the round starts you ask your question so um question equals input um we'll just say user and we'll start there or no um question there much better so then because that'll look like this question are you alive okay good enough um all right so question equals input so now we need to do some prompt engineering where we've got a secret word um here I'll leave the printing of the secret word right now um debug just so that I can whoops now python 1T question s oh I added a that's not supposed to be there like what did I do wrong Machu Picchu okay um good so if I if I at first we need to test is it a good question um so let's just say um uh let's see a user is playing um plenty questions they have asked the following question is this an allowed question it must be in the form of a yes or no uh question so question is um person place or thing and is this a yes or no question whoops why is it okay it doesn't understand um we'll give it a uh yes or no and we'll say false so what I'll do is if you do if you do low temperature and it's something as simple as this if you want very deterministic output you'd set the temperature to zero and give it a few examples um uh let's see so um I need to label um label it so what we can do is just shorten it to just this pattern so that'll save us tokens and it'll also make it faster because it'll do less processing and then you can also just use new line as your stop sequence um so we've got one example of each so far that's probably sufficient right false if it is not a yes or no question right true if it is a yes or no question whoops don't need to say that okay um that is probably sufficient and so then what we'll do is we'll just save this as our um valid question or here prompt valid okay and so then we'll do question here and its output will be what we want okay so first is Val uh no we'll do prompt equals open file uh prompt valid dot text Dot replace um question with question and then is valid equals uh GP gpt3 completion prompt and also do temp equals zero because we don't want any creativity with this um okay so then we'll do uh for this we'll do print is valid and we'll test this real quick whoops all right debug night I have picked my secret word ask your first question um what is the um airspeed velocity of an unladen swallow false okay um is it a thing true cool um is it a bug that's a valid question okay good all right so I think that works all right if is valid I wonder can I cast this as a Boolean oops I wonder if that works um bacon true uh let's see how do earthquakes happen true I think it's only doing true okay I don't think this works yeah let's try that again there we go okay foreign if is valid equals uh actually false because this will be the shorter use case if it is false then we uh we print um that is not a valid question minus one point to Gryffindor um okay so then we say uh um that's fine so and then then it just um it iterates so questions remaining equals questions remaining um minus one and then we do continue so if you're not familiar with python continue basically says okay wherever you're at in a loop just go back to the beginning of the loop um so it skips the rest of of whatever this uh whatever this is and goes from there that's actually probably Superfluous especially if I do um uh else if is valid equals um true then you continue and then the the loop will end here um actually one thing that I can do so this is this is my old school days learning Pascal C and C plus plus often um the the size of the program is constrained especially if you're doing like microcontrollers and so what you'd actually want to do is move this because you're always going to call questions remaining at the at the end right um and so rather than have that line repeated you then you just you um you do something like this so after your else if else statements um then you then you you go um so but the reason you might be wondering okay well why why do else like why not just do if else why do else if because there's an off chance that gpd3 will just spit out something else entirely um so we'll do um uh let's see um answer question um but then we'll do we'll have an else statement that just um print uh sorry um uh the machine is confused try again no points deducted and so we have this we have this like debug case so in this case because there's there's different possibilities um it would be easier um actually here so then we'll do continue here um because we're just skip skip to the end so we'll skip this and then what we need to do we'll say if questions remaining is less than or equal to zero um then uh #game over and we're almost done actually um let's see okay so answer the question ah all right so cat and then we'll come in here and we'll say a user is playing 20 questions that's a good start um they have asked the following question um let's see uh they have asked the following question um uh let's see I have to answer yes or no um uh as to um I have to answer yes or no um so let's see how is this going to look because I also want to do it like a few shot right um because like if the secret word is cat then I want to question like is it a person you'd say no so we'll start with the question um so secret equals cat question equals is it a person answer no yeah that should be a good format okay so then we'll give it a few examples of this so the secret would be um George Washington and then um is it is it involved with communication and the answer will be yes okay so now let's test this and give me one more for testing USA all right secret USA question um um is it a popular place let's see what it says answer and then we'll say um I refuse to answer yes yes and it's a famous place [Music] um is it um let's see is it in the southern hemisphere no okay good it looks like we're getting factual answers um so what we'll do is we'll copy this um and this will be our prompt answer dot text and so then we'll do Secret and we'll do question and then we'll leave that for answer so that's the the new line stop a new line that'll be good okay so um all right prompt equals open file we'll do prompt answer dot text dot replace Secret and this will be with um secret word and then we'll do dot replace um question mind blank for a second there let me bring some more of this coffee and then we'll do answer equals gpt3 completion prompt and so then we'll do print um we'll do answer and we'll do dollar or percent answer okay so the last thing we need to do um before we test the questions we need to say is it right um Okay so user asks a question and then uh check if user is correct and then finally um check if user has lost um actually I know if we go back to this prompt we should actually just add these and instead of instead of answering yes or no we'll say like final answer okay so let's do it this way so we'll just inject some of these um is it America will say um we'll say correct so we'll look for correct um so it'll be we'll actually have three three possibilities yes no or correct um okay is it Abraham Lincoln and so that's just a no so we'll add something like this um we'll say Harris Hilton is it Abraham Lincoln no all right so then we need we need some we need a like some correct guesses and give me a new question a diamond okay and we also need to replace guests with questions so that we're consistent okay Secret Diamond um we've got plenty of nodes so like let's say like um is it diamonds and this would be correct Okay so we've got one two three examples of no we've got one two three examples of yes and only two for correct so let's get one more correct so then we'll have three examples of each category so that should be enough to generalize gazelle um is a gazella type of antelope gazelle is it an antelope and we'll say correct so like again this is this is the easy mode so we'll say like as long as you're close enough um okay so now we come back into our end to here so is it valid yes or no okay um if it is valid then we get the answer um and so then if so here we want to test if the if the answer is correct then you win the game um so if answer equals correct um then we say uh actually here let's do this first if answer equals correct um rent um uh congratulations you won you won the game and then we do exit zero technically if you're building a game you'd ask if you want to play again but I'll let you figure that out if you want to do that um otherwise it will just give you the answer um it'll just give you a yes or no okay I think that works all right so now we checked if we checked if they're correct by doing a little bit of prompt engineering so then last we check if they have lost so we we subtract one um and this is pretty easy so we say um you are out of guesses the correct answer was I'll do that um and then we'll do uh what was it secret word and then we'll do Exit Zero here um okay I think we have a game CLS okay so I know that it's jungle I have picked my secret word ask your first question questions remaining oh I need to do that um and you go there on foot yes okay um is it a biome of sorts yes okay is it a desert now is it a forest yes uh um what kind of forest is it that is not a valid guess question minus one point to Gryffindor um [Laughter] okay so this is actually kind of hard if it picks the word jungle um is it a jungle correct you won the game okay so this is going to be hard um all right so we need to make sure we do um print questions remaining um yeah this is good all right let's take a look at this output and see like answer like question answer question here we'll just put um we'll do percent s here and then we'll do questions remaining so that'll just save us a line um I have picked my secret ask your first question um is it a person no is it a place yes um is it a uh City no is it a biome no yes is it America no um is it in the Eastern hemisphere no is it in the I'm gonna die Western Hemisphere yes okay it's in the Western Hemisphere so it's got to be um is it a national park um or something like that no is it a state couch I don't know if that's technically a place that's more of a thing um okay I'm going to add this into the um into this ouch is it a thing yes okay all right I think that's good enough um get status get add get commit am um all done and get push so there's lots of little things you can do to improve this um if you want to play with this by all means um make another list of common words or harder words if you want to and you could also do a um take this out instead of and do um do a game Loop where it'll just keep playing um but yeah so there you have it we have we have again a 20 Questions game with gpt3 thanks for watching have a good one like And subscribe and consider supporting me on patreon have a good day