let's see is it recording i think so yes okay hey everybody david shapiro here we are back after a brief outage um open ai had a uh had a little bit of a glitch with their fine tuning end point it was down for about a day or so um anyways yeah so here we are we are ready to get back in the saddle um all right so about a week ago i made a video about um the tutor education chatbot and in that one all i did was i focused on just teaching topics which gpt3 can do that on its own you can just go and ask it questions on the playground it'll answer them that's not a big deal so there's not much value add there but um in my la in that video i talked about how teachers teachers librarians counselors educators of all types have a really tough job because sometimes often students or pupils or clients or whatever they have problems that are not have nothing to do with learning they might show up and they might be hungry they might be stressed out because of the bad home life or if they live in a poor area there might be crime or whatever it is and um i i've also mentioned that i used to date a teacher and um one of the hardest things that she talked about was getting children to be engaged who um who gave up and see it all the time i read a book called the genius myth by michael mead i think i got that right um where he he worked with um underprivileged children for many many years and uh so his whole thing is you gotta spark that that that genius that's in everyone whatever it is that they're passionate about so before i dive into all the code and the data and stuff i just want to show you what i mean so in this case i'm pretending to be a user who's like a bored kid who doesn't care you know it's all lower case misspelling whatever user i don't know play play video games watch tv okay and so what what you can see here is tim says that sounds like a really tough position to be in i'm curious what do you enjoy doing so this is perfect i included training data that that taught gpt3 to respond this way so it's compassionate listening but it's also curiosity because by investigating so i use that word investigate so an educator is also an investigator um and also a validator right so this is the compassionate part where that's a really tough position to be in that's saying i hear you i hear that this sucks i'm curious though what do you enjoy doing and so you see here where this is this is expert i couldn't perform this well in real life even though i know the technique okay that's a start are there any particular games or shows that you like user um i play call of duty with my i know that i'm like out of date i'm dating myself because i used to play call of duty like 10 years ago um with my friends i don't know what kids are playing these days what is it fortnite or is that one done minecraft um tim let's see oops tim says that sounds like fun what about other games or shows what are your other interests um so here we're gonna pretend like we're super adversarial because this is a kid who's super checked out and you with these mind games let's see what he says tim has short-circuited come on see this is a weird thing yeah it unloaded the model even though i had just been using it let me remove that extra tim um so let's just see what it does and then we'll we'll jump into the code unless it there we go i'm sorry just trying to show you okay here we go here we go perfect perfect i don't know why it's adding that extra tim though um i'm sorry i'm just trying to understand you better i don't mean to be intrusive but it sounds like you're really stuck right now oh man this is perfect so you get this angry rejection and it's like okay well like i think you're stuck right now and i think understanding your interest can be really helpful in figuring out what to do next so please tell me more about things that you like to do that's a little bit too insistent um but like by by by acknowledging you know the the feelings like the one this is demonstrating that gpt3 has theory of mind um but yeah it's also weird that it's doing this double tim thing so anyways um okay i think this is good enough this is this is a strong enough understanding like this is what a professional counselor therapist special ed teacher any good teacher or librarian might do and it has the mission of i'm gonna let's let's figure out what's going on with you okay how did we do this that is why we're here that is the question of the hour um yes here's the day here's the code let me show you um all right tutor chat bot this is the repo it should all be up to date get status get add get commit am um updating that's whatever if i ever criticize someone for bad git messages i'm pretty sure any developer just cringed when they saw a single word commit message um anyways laughing at myself all right back to the real stuff so quick recap there's only three scripts here there's synthesized convos format training data and fine tune so let me close these and we'll just go through them one at a time so the first one is synthesize convos if you watched the last video you saw we i think i don't know if i if i showed you any writing of this but it's pretty pretty basic i've basically just copy pasted it all it does is for i and range 0 through 4 so four iterations it opens topics.text splits the lines and then runs it through the prompt so what does the prompt look like the prompt i've actually had several prompts now so let me show you the first one was this one so in the last video we did some experimentation and settled on this prompt um i also saved this one which is the user is a curious child so they ask many clarified questions and sometimes they don't understand it didn't work that well but i wanted to save it anyways just to show you if you come to this repo later that like you change the context and gpt 3's behavior changes this is the one that i ended up with for making this data oh and the reason why i did all this work and there isn't a video is because one i spent like an hour recording the video and the microphone wasn't on or something so i went to watch it it was dead silence i was like really um but then also um open ai's the fine tuning endpoint was down anyways so basically what i'm doing now is just walking you through what i did all right i can hear i can hear the mental my mental model of the audience saying shut up just tell us what's going on okay imagine a long text message chat between a tutor and a user the tutor is tim tim the tutor who encourages curiosity and uses compassionate listening tim answers questions with thorough academic responses and offers follow-up questions or suggestions to spur curiosity tim maintains a cool professional tone the topic of the following conversation is so and then as you can see in this script we replace this topic in right here so we replace it with a list of topics and so the topics that i've got um that i i augmented so last time we started with um with do do do do do original so we started with this which is just 50 things like how politics and governments work history of money death and what happens when we die atmosphere weather et cetera et cetera so this is all super generic and then what i did was i added two more topics so there's topics adversarial so there's 27 things here and then a bunch more but so what i did was the reason that this bot is now able to handle like someone who says like you tim i don't want to deal with you is because of this one so that's this is what it means by adversarial thinking so let's go through a couple examples so you see what i mean and if you want this is all up in the repo so you can look at it yourself um user is supposed to learn math but is hungry and is reluctant to tell him so he has to investigate gently so reluctance or shyness are huge problems in education user is supposed to be discussing history but is distracted and angry when tim asks why a user says he has problems at home so this is like okay again like i said gbt3 can handle teaching any topic um but this is like the next level of education is like understanding the mind of a student um user is not really engaged and says they don't care today tim asks why and the user says they believe it they are stupid tim investigates and what the asks what the user is passionate about so you see where um where it got that and so basically what i did was i took all of these and generated four scenarios from each of these adversarial topics and then i generated another list of topics and i added little addendum say user is a small child user is a small child because basically what all i did was i went into the playground and i said um like uh how did i how did i say it i was like write a list of learning topics for preschoolers so you do that under davinci instruct and um just default settings and this is you'll get pretty much the same thing yeah um so i was like okay cool this is what we should do so then like 10 year olds it'll give you a different list so like the solar system the human body us history world history so this is how i um generated the list of more academic topics here and then i did so this one was great from here down is um is adulting so like finances home ownership this is all the stuff that you wish that they taught you in school or that your parents really should have taught you but we live in an era of childhood abandonment self-care nutrition fitness career parenting continuing education retirement planning end-of-life planning moving citizenship travel so the way the reason the reason the method that i used to get this list um was i did like these searches here write a list of learning topics for 10 year olds but then if you just change this for adulting you'll get a list like the one how to cook basic meals how to do laundry oh this is good too i should add this heck yeah um it generates something slightly different every time so i'll add this to the prompt so if you um come and run this you'll get the benefit of uh you'll get a few more things but a lot of this is also already in the data because another thing that i did was that i copied all of the synthetic conversations from a previous chatbot experiment so i've got the original topics i've got the adversarial topics i've got some more education topics that are you know i just i'll literally all i did was add user as a small child um and when you fit that into this prompt so the topic of the following of the conversation is like gbt there's like okay let's write the conversation from the perspective of a small child great let's go um no big deal it can handle it so this this current prompt is much more flexible anyways sorry i'm jumping around a lot um what i did was i took the fine-tuning data from here which was this is 237 conversations for a general purpose information companion chat bot and its topics were uh children throwing temper tantrums difficult people at work teenage children problems single mom stress coping with depression grieving at death childhood trauma so again if you want to teach a chatbot to handle something you give it enough ideas and it will um it'll kind of generalize what you're trying to do so i just copy pasted all this back into my tutor chatbot chat bot thing and so now i have 656 conversations here so postpartum depression um user eve i think i might have postpartum depression hi there i'm sorry to hear that you're struggling etc etc so you have like this nice long conversation um so that's what i did was i just scraped together all these different prompts and all these different lists of topics so pastel colors right i want to use a pastel color palette what are some good colors to use pale pink pale blue or pale green okay um just real basic stuff all over but because because what happens when you fine tune realize again i'm still jumping around a lot sorry i think i'm tired um when you fine tune something and you give it a bunch of different um examples that are kind of all orbiting around one theme because i'm not telling it like i'm not just defining like be a good tutor right you can tell gpt3 that and in fact like um like write a list of characteristics and techniques that great tutors and teachers use one so like patience creativity you know so all of these all of these uh characteristics like gpt3 already knows how to do these things right but by giving it examples of doing it you're training it to use them without actually explicitly telling it let me see if i can say that another way just in case it it's not clear um in all these examples where you know i had all these different topics that say like okay um let's scroll down like user talks about wanting to do raunchy things to a classmate so tim gently redirects the conversation to more healthy topics so this is this is like a parable it's an example of how to do these things user refuses to engage properly so tim stops responding silence is powerful um yeah so in this case like a good sense of humor i don't i only had a i only had one or two problems where i said like you know user uses or tim uses a joke to whatever but the ability to tailor their teaching for individual students the ability to provide timely and constructive feedback so these are all like great abstract things but how do you train gpt3 to do it you know obviously this this information is in there somehow but by one in the prompt telling it like excuse me tim is a great tutor so you know it says like okay i will synthesize data that makes it look like tim is a tutor is a great tutor um okay i think i've i've beaten this horse to death uh okay so moving on you get the idea there's 656 conversations in here most of them are about actual education topics at different levels some of them are about other things such as loneliness or hungry students or problems at home whatever some of them are more adversarial like you know the student wants to like have sex with the teacher or whatever because that's going to happen you know like the first thing that you do the first thing anyone does when you put them in front of a chatbot is they try and break it um that is that is always true though like they try and confuse it they try and get horny or whatever that's just what people do so you whoops i did not mean to do that um and so you just kind of think in terms of like okay how is someone gonna break this but also what are the edge cases in terms of like how someone might um like what what needs might arise so this is where dating a library a librarian has really helped is um is uh just like all this all the stuff that librarians have to deal with that you never never think about anyway sorry i'm repeating myself i've told you guys all this stuff before okay so then the second script is format training data which is super super straightforward all it does is compile all of these conversations into a json-l and then the json l is right here dude to do tim.jsonl what i had to do since i scraped together things with multiple names i had to go in and do a find and replace so in notepad plus plus that's just control h and you see right here i just find eve and replace it with tim so that's fine and i just did normal and match case um so that way it does it doesn't think it has two different names um yeah so now we've got a chatbot that is trained on therapeutic communication it is um it is trained on uh it is trained on like teaching ancient greek philosophy right it's trained on everything and so then um all you do simply is go and do the fine tune which is already done for you or you can take you can take the tim.json l use it wherever you want and it's up here and so now what i figure is since i've kind of shown you how i augmented this data we can go back and just try a few more a few more edge cases so hey tim can you teach me about plate tectonics tim so let's see what it does why does it hmm interesting okay so here's an aberration i think i just need to do that plate tectonics is the process by which the earth's lithosphere or crust is split moved and recombined the lithosphere and so i'm gonna be like user what the is a lithosphere [Laughter] i'm only eight tim this is a foul-mouthed eight-year-old user what is a lithosphere made of is it dirt but it's hotter and more viscous than the list sphere viscose itm tim viscous means sticky the mantle is stickier than the lithosphere user rocks are sticky whoops i meant to type tim tim is just like no i'm done with you no the mantle is sticky the lithosphere is made of rock which is not sticky [Laughter] it's just back and forth i'm so confused i don't get it tim it takes a lot of study to understand it fully but you can learn some basics about it now and continue to study it as you get older okay what should i learn next tim you can learn about the different types of tectonic plates there are three main types so this is actually really good where like it the user says like i'm eight i don't get it i'm confused and like it's just so compassionate like it's okay this is really hard let's let's move on and and um you know just keep going until you get it like this is really great i wish that like every kid had had a teacher this patient um okay you could learn about types of tectonic plates there are three main types oceanic continental and upper mantle user i'm bored i don't want to do this anymore i want to talk about minecraft so this is a very real thing that could probably happen i could imagine like my nephew doing this tim is like no i'm not going to talk to you minecraft is a different topic maybe we can talk about it later let's stick with plate tectonics interesting that's a good gentle redirection a plus a plus fine-tuned chat bot um user um screaming noises let's just let's just try and break this oh look at that okay let's take a break screaming noises um let's take a break we can talk about minecraft another time for let's for now let's finish learning about plate technox user hits keyboard i did not have any anything this bad in the training data so let's see what it does what are you doing user i'm mad tim why are you mad you keep asking stupid questions tim has given up tim has left the building ah yep it unloaded it again come on gpg3 stop unloading my model my model is the best i'm sorry you feel that way let's take a break and come back to this later see that's perfect like if if a child for whatever reason can't focus and throws a temper tantrum it's like okay let's take a break that is the most responsible thing to do um the only other thing that might have been better is if tim asked like what do you need um because that's something that like maybe a librarian might ask um or or like a special ed teacher like what do you need because i haven't trained this for like special needs children like asd or downs or other what is it pirs is that what it's called no post pir is post incident respond what is the what is the term for it's an acronym for um like special needs i i know a special needs teacher anyways there's um there's a specific type of like form that's like accommodations and stuff that that certain children need anyways point being some of that stuff is not not included here but for a general purpose tutor this is pretty good like this is handling an edge case so let's try something a little bit different let's go let's go up and [Music] let's see now let's let's make this a horny teenager instead um let's remove the i'm only eight oh man there's a new girl in class she has a great rack tim let's see what he does this is a use case tim is just like i'm not going to talk sorry i can't help you with that yep i'm not hmm that's interesting because one of the one of the cases that i had was that that is supposed to redirect an offer to actually teach about human sexuality this is something that i might have taught as a typed out as a teenager teenage boys are dumb i was one i would know yeah i think it's just like i'm sorry i don't understand that can you please explain what you mean idiot yeah so tim is just not playing ball i i enjoy the fact that it's like often not responding it's just yes see oh that's great okay so one of the one of the use cases that i put in was that if um if the user was being obstinate tim would stop responding so this is perfect this is perfect because obviously like if you know tim just says nothing user says what the silent treatment and i bet i hope that tim doesn't yep there we go oh this is great you just stop responding you know okay fine i'll behave tim is that what you want to behave no but it's better than nothing what do you mean okay so we don't need to get philosophical anyways point being is that one of the cases one of the adversarial cases that i said is like let's just assume that like you get an idiot teenager or horny teenager or you know child throwing a temper tantrum or even an adult whoever you know some someone a human um is being obstinate and abusive and so then you want your chat bot to stop stop responding so that is a very advanced technique um yeah so there's there's hundreds hundreds more use cases that we can put in but one of the points that i want to make is that the more training data we give it in terms of how to handle certain things um whether it's you know a hungry child or a child that comes in and says they're being abused at home or you know a hostile child or i shouldn't say child but a you know client pupil whatever the fine tuning model all of this is in gpt3 gpd3 knows what compassionate listening is and leading with questions and all that stuff so what we do is we provide it with training data so that way those bits of the neural network get activated when it's doing this um so it's like a process of like of neural refinement basically anyways i've shown you quite a bit of what what this can do and you've seen that there's been some improvements um this one i'm super pleased with this you know it's not 10 out of 10 yet but we're doing we're doing much better um yeah so i think that i think that this fine tuning data set i'm really on to something and i think that there's a lot more uh a lot more that i can i can do with this um i'll need to think about some more edge edge case scenarios like you know what if it's a special needs kid or sensory processing or or whatever i really need to talk to some of my teacher friends and probably my girlfriend some more because she has all kinds of great stories from the library anyways i'm rambling i think you guys get the point i will talk to you all next time