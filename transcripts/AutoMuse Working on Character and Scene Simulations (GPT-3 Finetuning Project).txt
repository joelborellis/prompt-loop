morning everybody this is David Shapiro um today we're going to continue working on auto Muse 3 but what we're going to do is we're going to do a fine tuning project because um as many of you were observed um Auto Muse 3 didn't work too so well that's fine this is a research project so what I'm doing is I'm breaking out into scene simulation so basically what I'm going to try and do is create a fine-tuned model that will simulate just the scene aspect so we'll see how well it does but basically it's the idea is you give it a scene and then it just kind of advances you know whatever happens next in that scene and then we'll do something similar for maybe characters or events not sure yet but that's the point of experimentation so anyways I was trying to do it with just prompt engineering and it was Ultra frustrating so I'm gonna go more more conventional fine tuning so what I'm doing is I've got I'm generating synthetic data first so what I'm going to do is I've got this prompt where it says use your imagination to describe the following scene and setting in great detail we want to see a play-by-play of what's going on in this environment Advanced narrative what is going on here so I give it a location a time a character and detailed description of the scene in events and some of you notice in previous videos uh something that I do to add more entropy is I add uuid at the top this creates internal entropy inside of the model so that you're going to get less repetition so basically I've got this is completely random and then three other variables which are populated here so I've got 11 locations seven times a day and then nine characters and I tried to get a little bit more Global because here's the thing if you just ask gpt3 to Generate random characters they're all going to be like vanilla white people so I added Michonne swathi Wang Alexi and Gabby just kind of manually saying like Okay it's only half white people um uh yeah so all together I think this is going to be over 600 um different settings um so the goal here first is going to be um to fill up this folder of just basic scenes um so generate scenes I've got the temperature turned up to one so that will add more entropy as well as the um the uuid okay so let's run this Loop once um just to test it to make sure so we'll do uh python generate scenes so it just says a bedroom Jenna a high school or middle of the night um Jenna wakes up in the middle of night her heart pounding in her chest you can hear strange noises coming from outside her window um Okay cool so this is pretty creepy shake the feeling that someone is watching her um so yeah this is a this is a great first scene um yeah uh so let's check the uh prompt uh yep so this is this is what it generated so you see this just random words and letters gpt3 doesn't know what to do with it so it's going to end up with a completely random internal State um so that increases more entropy which is really good if you're generating synthetic data but this is a phenomenal first scene okay and then that should have saved saved it out here um yep okay so this is one advantage of uh open AI having cut their uh their price um by 66 by two-thirds um here just do that um is that uh suddenly um generating synthetic data is way more economical so I'll just show you this we'll let it run for a minute um although these responses are kind of slow okay so then basically what I'm going to be doing next um so you see how it all has like these these uh these different scenes um God it's all so creepy it's like it wants to write like teen lit horror [Laughter] um okay anyways uh so the idea is I'll take these so this will just be a whole bunch of scenes and then I'll write an entirely different prompt to um to advance the plot like to say what happens next and so we'll have an original scene and then the next scene and what we want to do is fine tune a model that that really advances the plot one scene at a time um and the idea here is that we'll have something that can um that can really kind of simulate what's going on in a given scene um that's a long one um okay so anyways I'll pause it this will take a while um it's weird because it seems like open AI is slower I seem to remember these going faster anyways I'll pause it we'll come back this will probably take I don't know a couple hours okay I just wanted to show you a little bit of progress so I've gotten the next step um ready to go where I'm gonna generate the next scene so it's almost the same prompt but um I just have seen and detailed next scene a playground and um yeah so here's an example Bob steps into his bedroom blah blah and detailed next scene um yeah so this pretty generally uh reliably generates the next scene um okay so what gives like what am I gonna do with this because this is not um this is not including events or characters or anything um so I'm glad you asked what I'm planning on doing is I'll fine-tune another model that will take any given character and kind of simulate what they want to do next um so it'll take like uh the perspective the POV of one character or rather the interiority of a character and say like okay this is what I'm thinking this is what I want to do this is what I want to say um and so then by having a model that can simulate any the head of any character that can be injected into the scene um or the next scene and um can be used to kind of prompt it uh and shape it and then so the basically the the point of this is to ensure that these instructions are followed every time um but also that it's not going to get bogged down on any given um uh prompt because you didn't see this because I deleted the video because it was a disaster but with just prompt engineering on text davinci02 what happens is that it converges on one result and it stops following instructions and rather than advancing the plot so what I need is this sorry that microphone was over there I hope you can hear me um so what I need is for the um for the why is my brain so scattered lately um because it's super early and I haven't been getting as much sleep as I need um yes so by having a fine-tuned model that will reliably kind of integrate whatever is in one scene and Carry It Forward I can then use that as a launching point to integrate multiple uh other models whether it's prompts or fine-tuned models such as an event simulator or a character POV simulator but what it will do is it will reliably integrate all that information that exists here and then spit out the next scene and so that way you kind of have a bunch of things that kind of funnel into one one event or one um one step one instance and then it generates a new scene and then you can take that new scene and um integrate more stuff into it so that's my that's my hypothesis so I'll go ahead and pause it again um we're at uh let's see 300 so we're about halfway done generating um the initial scenes okay I'm kind of bored uh watching this go 450 out of I think 660 so about two-thirds of the way done um all right so I'm thinking about the scene simulation this is going well um but I want to go ahead and start um character simulation as well so we'll just do um character simulation and so this is going to be uh like stream of Consciousness slash interiority simulation for fictional characters um Okay add readme and then license will be MIT create repo and then we'll come in here and grab this all right so in this case what are we going to do for the character simulation um let me go ahead and do this and character Sim and we will copy over um some of the stuff from here get ignore and then open Ai and then we'll do um generate scenes okay just instantiate this new one um all right so character Sim gpt3 logs and then all right so what goes into interiority right so if we look at um if we look at some of the scenes right Sandy sat on the edge of the mat this is kind of like the camera is looking at a person and it's like you know you might have some interiority right so like Sandy's watching her children play she loved this quiet beach so that's that's a little bit of of in her head right but in order to really write fiction you as the right as the as the author need to be simulating what is in someone's head um so let's just grab this and go over to the playground oh so I brought this up um uh generating synthetic data is way more affordable now um because uh look at this I've got 500 requests and it's three dollars so that's a lot of synthetic data um anyways let's go back to the playground all right so um let's see uh um rewrite no um so we'll say scene it'll say uh let's see imagine um the POV of the characters here um of the of the main main character we'll say main character because some of these have multiple characters um imagine the POV of the main character um right their stream of consciousness Consciousness there we go um or interiority um scene um for this scene uh okay so we're basically just going to take a scene and then translate it into interiority um so let's do interiority let's see if this works okay it's just repeating it um I don't think I don't think it I don't think it's sophisticated enough to understand what I mean by interiority um what if we do let's see rewrite the following scene into the main character's POV um focus on interiority and stream of consciousness um interiority and stream of consciousness it doesn't know how to do that um because what we what we'd want to say is like rewrite it into first person um actually yeah let's let's just do rewrite the following scene into the main characters first person view okay rewrite as first person now that's interesting okay yeah I like this I like this okay so what we're doing is we're just reframing it um so it's instead of instead of watching it from the outside we're saying I um okay so this is good this is a good start so let me go ahead and save this as a prompt um so we'll say scene and so then we'll come back out here to character Sim and we'll do um prompt first uh okay but we need a little bit more right because a scene um is is good and it implies things about someone but we also want to have uh something about the characters uh beliefs so for instance when you when you write a character there's a bunch of stuff that goes into making a good character right so what goes into making a good character here let me zoom in a little bit um well here let's just do this um what makes a good character um write some uh let's see brainstorm some key features of good characters for um fiction authors okay that's this is um not key features write some uh detailed features foreign there we go all right good character is believable and relatable has a clear motivation well-rounded and has both positive and negative quality so undergoes believable development in the course of their story so that's good um so to put it in other terms you might have a character has a past right a past or backstory people don't just pop into existence um so we'll say people don't just pop into existence um a character has uh beliefs um let's see about themselves the world Etc um a character has preferences because basically you're not describing characters you're describing people right um likes dislikes Etc um let's see a character has motivations and goals what do they want today tomorrow from life um a character has connections connections friends family Etc so basically what I want to do is let's figure out how to stimulate these characters um so let's take let's just copy whoops copy this real quick and we'll do all right so we got some characters uh or some some some things to aim for right actually here this makes sense to store in the readme um what makes a good character my character is just a fictional fictional person what uh um what traits do do interesting people have so copy this um yeah so we'll replace that with a good character all right so we'll just save that real quick okay so we can translate a scene into first person but what else can we do um so let's say uh given the following scene describe the main character in great detail um imagine the details if you need to all right scene so there's the scene um let's see uh [Music] uh let's see figure out the following um let's see we want their uh list out their backstory their backstory motivation um uh let's see beliefs flaws strengths um preferences likes and dislikes um let's see motivations or goals beliefs and connections friends family Etc okay detailed list of character traits and so then we'll just copy what's up here so we'll say backstory now let's see what it does oh this is great it can also be quite gullible kind and caring she's also very brave preferences Sandy's like the likes the beach and ocean Sandy's close to her parents and her siblings she's also close to her friends um let's add like list friends um okay but this is good we're off to a good start okay all right so let's go ahead and copy this so basically what I'm going to do is I'm going to um take the the synthetic data that I'm already generating about these characters and use that as a launch point to get that interiority as well because the thing is is you need to know these things about a character in order to simulate their mind because if you if you have a list of say like this is what this person wants or thinks or believes that that dictates um like how they how they'll respond to the world um oh we should do personality personality and connections yeah okay so then we'll come back out here and do character simulation and we'll do prompt um uh we'll say characteristics and that will say traits because you don't want to say like character characteristics you'll say character traits okay so this will be good um yeah so we won't need so getting getting someone's first POV is good um because then because then what we'll do is you can you can get you can put in a scene or you can actually have a like a running run on um Consciousness like stream of Consciousness and that probably what we'll do is actually just translate um all of these povs or all these scenes into first person and so then we'll have one set of data that will be like the scene is happening but then we'll have another set of data that is like this is the character but what we'll need is to have like the characters traits so that way you can just have that as like the character's core Constitution um yeah okay all right well I'm gonna go ahead and pause it because this data will take a while to finish um and I'm also like branching out in different directions I don't want to get make this video too confusing all right we're at 588 so um got about 100 samples left we'll be back in a minute okay we are rapidly oops you don't need this um we are rapidly zooming in on the final product so it's going to be 699 or so 694 I think it just finished um there we go all right so you might be looking at like okay why like you just did this with prompts what's the what's the advantage so the advantage is that um because because I've got the the prompts built in and then I have a whole bunch of data showing the structure so I'm not trying to teach it anything new I'm just basically guaranteeing that it's going to follow the right format okay so first let's go ahead and we've got our scenes folder which is 1.8 megabytes well I guess 528 actual kilobytes 694 samples so we'll copy our scenes directory over to our character simulation um because hey you know we just generated this data it's super valuable um and then what we'll do is we will um do so we've got next scenes right so now let's open up generate next scenes um and this is going to be so for file in files OS Lister scenes we'll print out the scene and we'll do prompt next so prompt next is going to advance the plot so we'll say prompt next long detailed next scene um this this works relatively well sometimes it's a little too short sometimes not um but yeah um so let's see use your imagination to describe the following scene in great detail we want to see a play-by-play of what's going on in this environment um let me actually well yeah uh okay I think this is all set so we'll come back here and do um let's see oh actually I know what I need to add do new ID um I think that's in here yeah generate next scene yup uuid scene okay so then we will hit play python generate next scene and so what this is going to do it's going to generate two scenes in sequence yep okay stretching his legs he walks over the stream and looks down oh this is great okay so this is generating synthetic data so that I have a very clear way of of telling the creating a structure where it says okay here's one thing here's the next thing and so what I'm doing now is I'm filling up in scene simulation there's next scenes and the file name is going to be identical so you have the first scene and then the next scene and they're all just going to be sequentially one after the other which will allow us to put whatever we want so here's the big Advantage is we're teaching it the structure that is the entire point of fine tuning is we're teaching it a pattern where it says okay given whatever input I give here advance the plot and so what I can do in the future is instead of having the original scene written by like a prompt or one shot it can be conglomerated by several things such as the character simulation that I'm about to work on okay so the character simulation we'll we'll we'll let the uh the scene simulation run in the background the character Sim um we'll do uh let's see first pause um okay so then we'll go to generate POV um here let's close some of these things because we're getting a little a little bit busy okay so generate POV um we do not need locations we can delete that um uh that's probably fine okay and actually here let's go ahead and open um scene simulation because generate next scene let me just copy a little bit of this okay whoops okay so we're going to print the scene we don't need the character our prompt is going to be on the character Sim so our prompt is generate first POV um actually we probably won't use uuids because this is mostly just kind of like a translation thing and we'll also turn the temperature down because we don't want it to be as creative we're basically just saying rewrite what is here um okay so then we'll do prompt and this is going to be prompt first POV and we don't need um we don't need the uuid so we're just going to replace um the scene with the scene so that's this guy right here and then we're going to do POV equals that and do uh POV and this will also instead of that will be file so just file and we'll save the POV um yes okay POV prompt prompt first POV print the POV and save it and not in scenes we need to save it in um what is the folder name that I created uh first pop okay first POV okay I think that's good so then we'll come back over here we'll see the character simulation um and then we'll do python generate POV it's mid-afternoon and Wayne is taking a break so probably what I'll do is yeah so I'm enjoying a cup of tea in my peaceful country cottage when I hear a branch snap startled I look around but there's oops um I'm walking uh I startled but I see there's no one there but the only thing I see is a deer standing calmly Okay cool so it changes it changes the scene from third person to first person which is basically what we're going to do is we're going to set the stage so that we're gonna have the original scene in the next scene will both be first person and so that will train the model to whatever whatever information we give it generate a first person POV which means that whatever it like we can put in beliefs and stuff so um one of the next things that we'll do like I showed just a moment ago is we will get the character traits so we can inject character traits into the simulation that will run the first POV we can also generate um stuff from the scene and events inject all of that and run the simulation with these fine-tuned models okay so I'll go ahead and pause it and let this run and we will end up with a bunch of first povs a bunch of simulation scenes and then we'll also get the character traits for these folks okay going is pretty slow so I figured I would show you some diagrams while I'm waiting I've already done the dishes um and taken out the trash so uh that's how bored I am waiting for this synthetic data to finish um and you see it's 8 30 in the morning now um okay so here's kind of what happens um or what what I'm planning on happening so there's the character simulation which is gonna be you know first person so it's like this is what I'm doing this is what I'm thinking this is what I want um then there's the scene simulation which is you know just this the third person the camera seeing watching what's happening other people interacting and then you can have multiple characters there's going to be one scene multiple characters um and then you can inject things like events uh beliefs backstory also all kinds of stuff so each of these simulations is going to be running in parallel and then they're going to merge and then the cycle continues so actually let me um let me add so then then it kind of goes back to the beginning um let's take this over here so this is how that's going to look and of course it goes the wrong way that time so it's just going to be a continuous cycle where um you know so then it advances by one by one step right one iteration so what what happens inside of the character simulation so the character simulation is the basic input processing output Loop of um of Robotics where you have here's the character has a base personality which consists of beliefs identity history and this is all their agent model so you and I have an agent model and AGI has an agent model a fully realized robot has an agent model which is why I'm doing this in fiction because if you can simulate any character you can also simulate a personality for an AGI and so this is how it all relates back to my primary work which is to create a benevolent AGI or ACOG artificial cognitive entity okay so there's two basic steps there's the inner world and the outer world and so there's input from the outer World processing and then output back to the outer world so you have an agent right here which you know believes personality uh identity history and then there's some kind of interaction with the outer world so an interaction is a two-way street but to think of it as a loop it's input processing output and so then the the outer world you know there will be a series of events there will be people or other agents um and then there's going to be actions right things that you do to the world and then stuff that it does back to you so that's the basic Loop here and that is the whole purpose of simulating um the uh the the character simulation so this is basically building a fine-tuned model to handle the agent model and so that's why we're doing first POV where it's like okay um oh I had it open somewhere else um I'm Gonna Cancel uh so anyways uh yeah so it's like III Mimi this is what I want this is what I'm thinking etc etc and so that is going to be combined with once I get this so this is that's the whole point of the character traits right because a list of character traits is an agent model right um for us humans it's all implicit that's what we might call ego or super ego or ID um or your identity or whatever those are all just different words to describe who you are as a person so in fiction we say like character traits backstory personality strengths weaknesses preferences whatever all this fun stuff that's all just an agent model and so if we have a general purpose agent model fine-tuned machine then we can put any agent model we want into it and simulate what it will do um which this will have multiple things one we can simulate uh well probably not real people uh not with any level of accuracy but we can at least uh simulate fictional people and this also sets the stage for testing things like AGI alignment because then we can have um you know artificial agent models for like despotic dictators we can have um we can have the fictional agent models for ordinary people that will make you know whatever like ordinary human decisions and then we can also have agent models for AGI machines whether it's a robot or you know an AGI Overlord whatever so that's the whole point here and it it so I realize that where I'm going with this might not be intuitive to other people but to writers it is very intuitive because especially uh speculative fiction writers but really all writers what we do is we run simulations of people in the world in our heads and then we put it out on paper in text and then we refine that text usually to make it more entertaining but we also try and make it realistic or believable to make it credible and so we're used to running these simulations in our heads but what's the difference between running a simulation if it's connected to an API that that you know can actually speak with you right and so this is where you get into like solipsism and and epistemology where it's like okay how do you know what's in your head right your head your your mind your brain is its own kind of detached World um that's interacting with the outside world and so this is why I put uh with moragi microservices architecture for Robotics and artificial general intelligence that's why I think that artificial general intelligence or artificial cognition should be a thought first model because then you have a thinking machine that happens to also be interacting with the outside world now that outside world might just be a fictional World it could be the real world um it might be um a game world right so once you solve the problem of of fictional character you know artificial cognition you've already solved the problem of real robotic cognition it's the same problem it's just a matter of what world is it interacting with so to put that another way um interacting interaction with world right what is the world here is this a game world is it the real world um you know within with an API it doesn't matter right the machine doesn't care um as long as it thinks that it's interacting with something outside of itself and it's getting information and feedback from that outside world whether it's text-based simulation 3D simulation cameras and motors and robots with the real world or what we call the real world we might be in our own simulation we don't even know this is why I coined uh Shapiro's law is because you cannot talk about AI without eventually talking about quantum mechanics it always gets down to what is the base nature of reality and where does Consciousness reside and what is the nature of Consciousness and all we can say is that Consciousness is an agent that interacts with something outside of itself um so yeah okay I'm gonna pause it again let some of this data go and then we'll be back and actually you know what this video is getting pretty long um I'm going down more rabbit holes than I thought I would so I think I'm gonna go ahead and and stop this video now and we'll come back for part two tomorrow and so just to kind of set the stage for tomorrow we're gonna come back to character simulation and um and scene simulation so basically what I'm going to do is I'm just going to set these to finish generating the data and then um and then I'll walk away and and stop there so anyways thanks for watching stay tuned we will uh we will continue this