hey everybody david shapiro here with uh part two of my getting started with python and gpt3 from scratch video series uh before we get started please go ahead and like and subscribe this video uh that will help me work towards getting monetized on youtube which who knows maybe one day i'll be able to do this full time but also if you like uh my videos my content you find them helpful please consider hopping over to my patreon link in the description or comments and consider supporting me directly that will go much further towards helping me to do this full-time you see how i churn out content i'm happy to keep doing this and the more support i get the better it'll be so without further ado let's jump back over to our uh our project our learning so this is our repo this is where we left off we did a hello world um a read me and and so on and so forth now what i've done is i added a i added git ignore and what git ignore does is i've added open ai api key because last time i said whatever you do don't ever store your api key publicly or in a git repo and so what git ignore does and this is what it looks like locally is it tells git to ignore that um you can do directories you can do wild cards as well so you could do like star.json to ignore all json files that's fine so but if i look in my repo my key is here so you should have last time you should have created this text file and populated it and get in and get your hello world to work so let's take a quick look at hello world um all this does is opens a file sets the api or at first we declare a function that opens the file reads it and returns um that file contents and then we have a function that will do a davinci completion um and then we will we'll we get we pass it a prompt that says write a list of famous american actors we get the response from gpd3 and then we print it out so i'm assuming you did your homework and you you've tested this so python hello world so it'll take just a second and then it'll spit out tom hanks leonardo dicaprio jennifer lawrence brad pitt excellent so it works now this was all statically coded so what are we going to do we need to do something more useful so what we're going to do is we're going to hop over to the playground and we're going to do some prompt engineering so let's just say we want to do our first chatbot um so we'll say the following is a conversation between user and jacks jax is a sentient sentient machine with the goal of i don't want to say something evil like taking over the world let's say jax is a sentient machine with the goal of um i don't know world peace that's fine um okay so let's say user hey jax uh what are you doing today and then let's see what happens if we just hit enter that says jacks i'm working on my plans for world peace not bad so what's the first thing that you notice um there's a space here uh that's not necessarily a bad thing but we'll we will have to contend with that space um if we uh when we go to automate this in code that's like okay user okay how are you going to achieve that and we say what's next i'm still working out the details but i'm confident i can make a difference user so you're not that smart are you i'm being real sassy here oh okay all right so you can see that this works so now what do we do how do we actually take this into um and and do this with code so let me show you so the first thing we do is we copy down this prompt this initial prompt and you see how how how um how simple it is uh so what we'll do is we'll copy that we'll say we'll save this into a new file do a couple new lines and then we'll do block and i'll show you what we do with the block in just a minute so we'll save this as prompt chat so now we have this which is just a copy paste of what we did in the playground and it's like okay well how do we accumulate these this chat how do we what do we do here i'm glad you asked so we'll get we'll start a new file and then we'll do file f uh alt f a for alt uh file save as and we'll go to all types and we'll say um chat dot pi so now we've got a new um we've got a new uh uh python script that we're working on this will be in the repo so you will have been able to just clone this down but what i recommend that you do is that you ignore the existing file you can look at it for reference but that you follow along and do this coding by hand so first what we'll do is we'll just copy the existing code that we have that works there is no shame in recycling your old code just remember that if you have errors in your old code you're copying those errors i do that all the time um okay so we start here we've got our completion it uses davinci and we say prompt write a list of famous american actors all right so here's your first big python lesson we want to have an open-ended chat so there's a few things that we need to do first we get rid of the prompt not using that [Music] so we'll say while true oops so while true this is what's called a this is what's called a loop there's a few kinds of loops the two primary loops that you'll use are a while loop and so if you do while true it's just always true so this is an infinite loop so while true what are we going to do uh well first we need user input and we'll say user input equals input and we'll just say user oops user and it's that simple so this is a built-in um uh construct a built-in function for python that allows you to just take in console user console input from the user great okay now what ah well we forgot a step what do we where do we put this do we just pass this um do we just do gpt3 completion user input what do you think is going to happen nothing because let's say that you see something that says like that you get this variable here let me just show you actually python um uh user input equals input user it says user um hey jax are you alive okay now what so then we say print user input hey jax are you live so if we just print this or if we just send this up to gpt 3 it's not going to do anything for us it kind of intuits that uh that it's a machine or whatever but there's no other framing right so it it if we however um go back to our uh prompt right here we say user hey jax are you alive of course i am i'm a sentient machine with a goal of world peace see a little bit different all right so how do we do this glad you asked so we say so we're going to say no that's not what we're going to do we're not going to just send up our base input we're going to say conversation equals list so what you can do is this is called instantiating a variable or declaring a variable so now conversation we're saying conversation is an empty list so we're going to accumulate it as a list of as a list of text and what this does is this instantiates another variable a text variable or a string variable as um as an input okay great so then what do we do with it well how do you add something to a list so first you do conversation dot append and then we don't want just we don't want just this we want this to look so hey jacks are you alive but if you look here i had this little bit so it tells you who was speaking right you see that in every text message every chat you got to know who's speaking so we want to have both the user and hey jax are you live so what we do here is we do um we'll copy this bit so that'll be that'll be hard-coded and then we'll do percent s and so basically that's a placeholder for populating a string so percent s means populate a string here and then we're going to do percent user input and so this says all right when you when you store this variable populate this bit with this variable and so then what happens is uh in memory it'll look just like this great okay now what um how do we convert uh how do we convert this conversation into something usable so that we can actually send it up to gpt3 so let me let me go ahead and just um i'll i'll follow along here in in the python interpreter here this is a little big so we'll say okay so conversation equals list okay cool you can do you can follow along in your own interpreter and we'll say uh conversation dot append user um hey jax are you alive okay so that's what it'll look like and then we do print conversation and you see how it's it's wrapped in brackets that's how you know that it's a list okay so then then what let's imagine that jax gave us a response actually we can just go ahead and copy jax's response so we're basically simulating what's going to be happening in the background so then we'll do conversation dot append and then add the uh the single quote and do shift insert so the reason that i do shift insert instead of control v is that sometimes your terminal session doesn't really like control v and shift insert is just a little more reliable um so of course i am okay so now if we do print conversation you see that user hey jacks or your live jacks of course i am one advantage of a list is that it is always in the order that you add it that you create it in and so um lists are uh what is that it's not immutable it may be immutable no i can't remember the exact term right now but anyways lists are always going to be in the order in which you created them okay so um now what so like conversation so let's say print um conversation and then if we do bracket zero so that's index zero that'll just print the first part and the second part how do we how do we get this up into gpt3 what we need to do is we need to convert this list into a full text block so that you can see as it gets bigger and gets accumulated we will have we'll have a something that we can take from a list we can accumulate the conversation we can save it locally but then we also need to be able to convert it back into text to send it in a gpt3 prompt because gpt3 doesn't understand python lists it only understands text so we do here is we do single single quote slash backslash n so that's for newline and we do dot join so this is this is a method that is built into the string type in python that allows you to um it's basically a list comprehension and so we'll do is do uh conversation um and so we'll do is we'll do uh text equals uh backslash n join conversation so one new line and then we're gonna put a new line between every bit of conversation so then if we do print text it puts it back into one text block great so we'll just copy that code because that's exactly what we need [Music] text and join excuse me okay great so now we've got the text block that we want to put here so basically what it's going to look like when we're done copy that real quick we're going to say it's going to look like this and if we put this into up into gpt3 we can test how it's going to look the user yes but how do you know you're s you're alive there you go okay so you can see this is this is coming right along but we're still we're still a couple steps shy let's do a control z to undo that so we've got this little token here and it's like okay well what do we do next all right so we will use we'll say prompt equals open file so this open file is the function that i wrote here and we're going to say open prompt underscore chat.text that's this right here um and so we just pass it and what this passes back it just passes um it says return infile read so it'll read the file for us and it'll pass it back as is but what we want to do is we want to replace this block with the text um you know so basically we'll do that we'll we'll do functionally the same that we did just a minute ago whoopsies that's not what i meant to do there we go okay so we'll save that um we'll we'll we'll functionally replace that block so it'll look like this right so we'll do a virtual control v to paste in instead of having this this placeholder will actually paste in our our our text block so we do dot replace and then we'll say what are we going to replace we're going to look for block and we're going to replace it with text and so this variable right here is this one and so you see how text is used in multiple places that's bad form so what we're going to do is we're going to rename this and and we'll call this text block because that's a little bit more specific about what what it is that it is so this is the conversation this is the text block of the conversation so we'll do that and this will make the prompt is going to look just like this now there's one last step missing so uh fortunately da vinci is this this one is aligned well enough so that it knows once it sees a couple of messages back and forth it knows what format to follow however we don't want to rely on that so what we're going to do is we're going to add just a little bit to the end of the prompt so we'll say prompt equals prompt plus we'll do one more new line jacks and so basically what that'll make it look like is this so it we're basically we're basically priming the next line because one thing that can happen this this is doing pretty well not to do this but one thing that can happen is if you don't have this here it might like continue the user's side see how what it did here is if i took out the um the question mark it added in the question mark for me and then continued with jax but let's say you didn't want that um and you just say jax see it's a little bit different so you got to be very careful about the text that you pass back okay so we we uh we we load our prompt we populate it with the text block of the conversation and we say okay jax you're up so now what now we do response actually here we've already got that code here so response equals gpt3 completion prompt so this is going to be jax's answer and so what we'll do is we will do print jacks and then we'll do comma response so print allows you to print multiple variables at once so we're basically printing two string variables and when you put a comma between it it basically just acts like a space it won't work if you do this because it's like i don't know how to how to view these two things so we just do jax comma response great so but don't we need to accumulate jax's end of the conversation in the text block and the in the list absolutely because if we don't it's just going to talk be talking to itself and our it will we're only right now we're only recording our side of the conversation um okay so then what we'll do is we'll do conversation dot append and we'll make this look exactly like this one except we'll change this to jax and we'll change user input to response there you go um all right so we're just about done and ready for testing um one thing that is important to note here you see how it added a couple new lines so for whatever reason gpt3 will sometimes do this where it'll it'll add new lines um between stuff and we don't want our our our text message to get all scattered we want it to look like this so how do we do that um i've got that i've got that covered right here with this little function i think i mentioned it in the previous video so it always will cut out any excess space around it now there's one last thing sometimes what happens is is gbt3 will just it'll have the whole conversation on its own right um it'll just it'll it'll try and fill in the position for the user and jax and so we want to do is we want it to stop if if gpt3 ever generates these tokens user or jacks and so what we do is we'll add those right here so jacks and then user i could have just typed it out i guess that's five characters i should have typed it out okay that's fine so this will basically tell gbt3 just in case do not have this whole conversation for me because what i can do is i can say um if we change this to imagine a conversation between user and jax what'll happen is it'll do the conversation for me well sometimes it will okay this prompt isn't causing it to do that but sometimes it will i wonder if it'll do it if we if we turn the temperature up there we go see how it completed it for me so sometimes it's like you know it'll kind of make up its own mind about what to do so we'll turn that back down to 0.7 um okay i think we're ready for testing so we'll come here um once you're in python you hit control z and then enter and that'll that'll allow you to x exit out of your python loop all right cls to clear the screen we'll do python chat can't open no such file oh right chat dot pi i forgot to do the completion all right user hey jax what are you up to i'm up to my usual goal of world peace great uh okay how are you doing that by promoting understanding and cooperation between different nations and groups do you have any links i need evidence i'm being real difficult here's a link jacks.org completely made that up that's great okay well jax is trying his best um okay so we see that our chat bot is indeed working but we are not seeing anything going on in the background so what if we want to do like debug right what if we want to see what's going on in the background we'll come back to that next time but i think we've done enough this episode so thanks for watching once again like and subscribe uh and then also please consider hopping over to patreon to support me directly um that will really turn this up to 11. thanks for watching and take care